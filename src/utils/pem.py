from cryptography import x509
import typing


def get_domains_from_certificate(pem_data: str) -> typing.Tuple[str, typing.List[str]]:
    cert = x509.load_pem_x509_certificate(pem_data.encode())
    # We need to find the extension subjectAltName
    subjectAltName = x509.ObjectIdentifier('2.5.29.17')       # ObjectIdentifier(oid=2.5.29.17, name=subjectAltName)
    extension = cert.extensions.get_extension_for_oid(subjectAltName)
    dns_names = extension.value.get_values_for_type(x509.DNSName)

    parent_domain = cert.subject.get_attributes_for_oid(x509.NameOID.COMMON_NAME)[0].value      # Subject <Name(CN=core.zuberipay.com)>
    return parent_domain, dns_names

    

"""
data = '-----BEGIN CERTIFICATE-----\nMIIHMTCCBRmgAwIBAgITMwCrjtWZd+A0utQnVQAAAKuO1TANBgkqhkiG9w0BAQwF\nADBZMQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9u\nMSowKAYDVQQDEyFNaWNyb3NvZnQgQXp1cmUgVExTIElzc3VpbmcgQ0EgMDIwHhcN\nMjMwNTIwMTMyNjIwWhcNMjMxMTE2MTMyNjIwWjCBizELMAkGA1UEBhMCVVMxCzAJ\nBgNVBAgTAldBMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQg\nQ29ycG9yYXRpb24xPTA7BgNVBAMTNHNiem8zdHR6cnZpeTZ0NC5lYXN0dXMyZXVh\ncC5hdGxhcy5jbG91ZGFwcC5henVyZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQC45hrKswbAwlsVAWxnX6DNJuaWsNHX8AK5I5r4MH1s5SUj940D\nMMFwIX2YQYZjHuAHf1gpp+ZwVgWtTZOnvxn0D2gagScB3SbQOU6dQtHqlD945K8V\nysFSYtKEvcN1v0Cwu62nWWSie7doq2RU+C5Ti7prZ/G/ETamUyfz9aQkp4/bBFhY\n6vOlJ+L+KpEtqFGH29ZUkE6mdiAg48H+1XMsPoytCH6lFm64YhTMBKIz1U9eEhEw\nVFK1182UURZyQwYKxy3GRhBuMNbLvr3/MZ9M8XwGsAnNPOMIAxY+lCnZ0oLvsihB\nL5KqJuzYleXfg4ukRkGwMQIo5TucWzArr+SxAgMBAAGjggK9MIICuTATBgorBgEE\nAdZ5AgQDAQH/BAIFADAnBgkrBgEEAYI3FQoEGjAYMAoGCCsGAQUFBwMCMAoGCCsG\nAQUFBwMBMDwGCSsGAQQBgjcVBwQvMC0GJSsGAQQBgjcVCIe91xuB5+tGgoGdLo7Q\nDIfw2h1dgqvnMIft8R8CAWQCASwwga4GCCsGAQUFBwEBBIGhMIGeMG0GCCsGAQUF\nBzAChmFodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2NlcnRzL01pY3Jv\nc29mdCUyMEF6dXJlJTIwVExTJTIwSXNzdWluZyUyMENBJTIwMDIlMjAtJTIweHNp\nZ24uY3J0MC0GCCsGAQUFBzABhiFodHRwOi8vb25lb2NzcC5taWNyb3NvZnQuY29t\nL29jc3AwHQYDVR0OBBYEFKPipaZXCc5VWK4c1kUQG7u7R/ZsMA4GA1UdDwEB/wQE\nAwIFoDA/BgNVHREEODA2gjRzYnpvM3R0enJ2aXk2dDQuZWFzdHVzMmV1YXAuYXRs\nYXMuY2xvdWRhcHAuYXp1cmUuY29tMAwGA1UdEwEB/wQCMAAwZAYDVR0fBF0wWzBZ\noFegVYZTaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3BraW9wcy9jcmwvTWljcm9z\nb2Z0JTIwQXp1cmUlMjBUTFMlMjBJc3N1aW5nJTIwQ0ElMjAwMi5jcmwwZgYDVR0g\nBF8wXTBRBgwrBgEEAYI3TIN9AQEwQTA/BggrBgEFBQcCARYzaHR0cDovL3d3dy5t\naWNyb3NvZnQuY29tL3BraW9wcy9Eb2NzL1JlcG9zaXRvcnkuaHRtMAgGBmeBDAEC\nAjAfBgNVHSMEGDAWgBQAq5H8IWIml5qoeRthQZBgqWJn/TAdBgNVHSUEFjAUBggr\nBgEFBQcDAgYIKwYBBQUHAwEwDQYJKoZIhvcNAQEMBQADggIBADieKVj/nK/Fmxms\nbWFAaYQyU/rmZwFmJJYlOyHdR4mg4zNyFxeGof6hhjUtB/0ofdr4rRJqSyMkGJXM\nyM8Ebjq6TtI+EwJ+tBU0JLzrvyeg0WxDY2PLmc3Tu+9MqFXOQDdGy46ApA7AO97K\ndV67K37OcRtZjtC5/GVnNjlK/BxEWWo3xObamoWMB/68LqkYzuiMLLpPBPeVafAj\nvh8hrwWlcFTMsaAExdM75OYsMitQ43c1hzzDM1qp4lrPedvvlYReKtdBojZpnNtE\nvt4HgNhI5leaIPeEkDPRXdqqMw27yuinCLZGaEYmUIE5r3/e8NpGS/8Bs48L2g1W\nMtiB0ULcqTaMY/CFwAOLZANgfARr4LHs3aZffbwusvWX0wFBe45GXXo5ryTlEecC\nO4ajUKGGGJ9VI97Yw9EkvqhuH/Hf1C+vyHn5pFXR5z/Vot5mAM9g5cXdawrgDfK4\nfgHHINjoB7WhgrF+PvGK58oEIiaq4iwS3FoUhd4BaAxoCgGqzHdljSXgKCtJHx1O\ndzEtm9C79wCE2HXNMvG8Wd6qXmX1qNIhmPxMKe4dZLg4IkSeGP0U/T7hOyX+gXF/\nWVqh/k+RhgrLFnYrj/A76iH2w+KDVLyk4ONQQQv+W1BNmqYDyMs4kQhJVwEVb45m\nCCjdee46B/lJEDy0cUcrtg0wQ3yz\n-----END CERTIFICATE-----\n'

data = '-----BEGIN CERTIFICATE-----\nMIIMHzCCCwegAwIBAgIRAL8SEe4R3QN9CT1VrFC/B2EwDQYJKoZIhvcNAQELBQAw\nRjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM\nTEMxEzARBgNVBAMTCkdUUyBDQSAxRDQwHhcNMjMwNTEwMTgyMDI3WhcNMjMwODA4\nMTkxOTAwWjAdMRswGQYDVQQDExJjb3JlLnp1YmVyaXBheS5jb20wggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDSIDj51QpaAyxyMLB6KzB6Dj8DTy7Gt8co\n3AacDr/P443tnK1ZoCC/H6r4RKqCB9U5jrxiCwSJOcegOGmCCtatvrYJ/8cF6LrM\nPjC4kAIVEzgq1IpYcgWyP2MthqppaIib8LPih+znXBICLEjz2WWEwD2n79SJq3tf\ndjediGt/F8FDglFPqOfk73xzyq/YywJbdk1OhvlZHpYnEFLZBaT/+1UwyM5OGLr3\nBqHXdsgVyCXekGUP/K5ELQn33VOpZX0JiBXXJTW2yHj0IRdkPzaNeq0ThQJQnZVH\ngbCtGFymhrHNw6uFPIQ+diUcvYucRtDYkkpF0Yw56A6xV2Vzd76BAgMBAAGjggkv\nMIIJKzAOBgNVHQ8BAf8EBAMCBaAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0T\nAQH/BAIwADAdBgNVHQ4EFgQUBqnc2RQ9UPUbmO223RHnvRa3DPwwHwYDVR0jBBgw\nFoAUJeIYDrJXkZQq5dRdhpCD3lOzuJIweAYIKwYBBQUHAQEEbDBqMDUGCCsGAQUF\nBzABhilodHRwOi8vb2NzcC5wa2kuZ29vZy9zL2d0czFkNC9MT1hGbWF5SThEdzAx\nBggrBgEFBQcwAoYlaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzMWQ0LmRl\ncjCCB8QGA1UdEQSCB7swgge3ghJjb3JlLnp1YmVyaXBheS5jb22CD2JhaWJhLnJv\nY29sYS5lc4IKbWFwNHVzLmNvbYISbHlmZWxlc3NxdW90ZXMuYml6ghd3YXNocG9z\ndC5nYXRoZXJvdW5kLmNvbYIla3BtZy1zdGFnaW5nLnJlY3J1aXRpbmctc29sdXRp\nb25zLm9yZ4IKZmluZG1lLmZ5aYIVY2FuZGlkLnR1cm5vdXQuZXZlbnRzghN0d2lm\ndC12Mi50d2VuZGUuYXBwghFmZW5kaS5za3ktYm95LmNvbYIZZGFzaGJvYXJkLnVh\ndC5iZWF1Zm9ydC5pb4IRYWRtaW4tZGV2Lndpc3kuYWmCE3d3dy5jYWxsYm91bmNl\nci5hcHCCFnd3dy5seWZlbGVzc3F1b3Rlcy5iaXqCDmFpdG9wY29kZXIuY29tghd0\nd2lmdC1kZXYtdjIudHdlbmRlLmFwcIIecmVsaWFiaWxpdHlpbnRlZ3JpdHljZW50\ncmUuY29tghNpZm9ydGlmeWZpdG5lc3MuY29tghZhZG1pbi5kZXYwMS53b3dkZXNr\nLmpwgghsb3ZiLmNvbYIXbGluay5hZmZpcm1hdGlvbi5zdHVkaW+CDmhvdGVsZ2Fy\nZGVuLnBsggx3d3cucmVudGQuYWWCCHJlbnRkLmFlgg1zYXliZXJ5YWIuY29tgg53\nd3cubmVyYW1pLmRldoITaG93ZWRvaXRyb29maW5nLmNvbYIMcHdhLmJlbm4wLmJl\nghV3d3cuZ29saWdodGx5cGx1cy5jb22CEWdldGFwcC5hcHBvdGEuY29tghFtYWtl\naXR5b3VyZ3ltLmNvbYIPd3d3Lm1hdGVibGUuY29tghB3d3cuZXNmaW5kaWEub3Jn\nggpob3RpdC5pbmZvghFhcHAuc29ub2hhbGVyLmNvbYIRZGwubWVsb25rb3Rhay5j\nb22CD2RvY3VtZW50bm9kZS5pb4IUd3d3Lm1hcnRvcHN0dWRpby5jb22CE21pY2hh\nZWxhZG9uaXMuY2xvdWSCEnd3dy5qZXJlbXljcm93ZS5jYYIScmVwb3J0aW5nLmxp\ndHRhLmNvghN3d3cuYW5kaW1hbmlldGEuY29tghN3d3cuaTktaW5maW5pdGkuY29t\nggx3d3cuYmFyZWQuYXWCF3d3dy5ob3dlZG9pdHJvb2ZpbmcuY29tgg5pbnRlcm5h\nYmFkLmNvbYIad3d3LmhvbGRpcmRlaW5lbmdld2lubi5jb22CEXNwZWFraW5nYXRo\nb21lLmRlghF0b3VybmV5LW1ha2VyLmNvbYIWd3d3LmJhbmRhLWZlcmRhbWFuYS5z\naYIUd3d3LnNvbW9zLWxpbGl0aC5jb22CDmh1Y2tsYmVycnkuY29tghRjcm0uZGVt\nby5zdHlsb21sLmNvbYITZ2FtZXMuY29jb3JvaWQubGl2ZYIRYXV0aC5qaW1hdGh1\nYi5jb22CD3d3dy51bmlxdWxlLmNvbYIWbGlrZWF2b3NzZ2l2ZWF3YXlzLmNvbYIS\nYXBwLWRldi52aWF0b3IuY29tghpzZXJ2aWNlLXN0Zy50aGUtbGFjdW5hLmNvbYIS\nd3d3Lm5ldWJlc2FpdGVuLmF0ghdwdWJsaWMuemVuLXNjaGVkdWxlLmNvbYIWZ2V0\nYXBwLnNhdnZ5d29ya2VyLmNvbYISYXBpLnJ1aWx1bnRyYW4uY29tghR3d3cuc3Vs\nbHlzbGVnYWN5LmNvbYIRd3d3LnNocmV5cGRldi5jb22CC25vdHlldHQuY29tggp2\naW9tYXAuY29tgg53d3cubWVyYWtpLmRheYITd3d3LnRvbXN0Z2VvcmdlLmNvbYIL\nc2lvdmlldy5jb22CGXJhbmRvbWl6ZXIudmxhc2FramFrdWIuY3qCC3NyaW5pdXgu\nY29tghF3d3cuYWlkYW5kYXZpcy5hdYIbY2xpZW50cy5nbG9iZWV4cGxvcmVycy5j\nbHVighF3d3cuZWF6eWJ5dGVzLmNvbYINd3d3LnJmcndlYi5pdIIRcGFsZXJtb3Nw\nb3J0cy5jb22CGnd3dy50YWxsZXJmZXJyb21lY2FuaWNvLmVzgglsaW52by5hcHCC\nCGJtYXAuYXBwghZtZXNzZW5nZXIuc29tc3RhY2suY29tgg1icmFja2V0aXplLm1l\nghl3d3cuY29zdHJ1emlvbmlkaWdpc3JsLml0ghZ3d3cubWFybGxvbmJhcml6YW8u\nY29tghR3d3cuaW9hbm5pc3ppZm9zLmNvbYIKYnVsbGV0bi5pb4ITd3d3LmdpZnRv\nZmNyYWZ0LmNvbYITYXV0aC53aGlzdGxlaHViLmNvbYIMaXRzYWRlYWwuYXBwggx3\nd3cuYm1hcC5hcHCCEG5zcG8uaWRlYXNreS5hcHCCE3d3dy5kZXYua2lzdG9ybS5j\nb22CEGFwcC5lc3BvcnRlci53aW6CF2V1bGEudHlwZXRhbmljZm9udHMuY29tgg93\nd3cuYXJ0YWR5cy5jb22CG3N0YWdpbmcuYXNzZXRzLmdhbWlmaWVyLm9yZ4ITZGV2\nLnN3aWZ0c2NyZWVuLm9yZ4IRZ2Jzb2Z0d2FyZS5jb20uYnKCEmJldGEyLmNvaW5t\nZXJnZS5pb4IQd3d3LmdtbWFydC5xdWVzdDAhBgNVHSAEGjAYMAgGBmeBDAECATAM\nBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmxzLnBraS5n\nb29nL2d0czFkNC9EWUNXOWhOenJYdy5jcmwwEwYKKwYBBAHWeQIEAwEB/wQCBQAw\nDQYJKoZIhvcNAQELBQADggEBADOxQoItl0j1wAUeBpJsWEP0pq3WQB/8D9yuSy+t\n0yMTmr1j9ywxhJRl9eWqGHkimg5nxZ7ud3/+/ToVCEKJztfAHmluxulczZQvhxsY\nZ3JvTt33joH2lvUZtXSr5i0fCElEMXAo2II3sxVGfzf0srsxA8mmXrSmAeSycJVf\nRkARyrW9/vPwmgLCMn/tM3m3vqzkrPnFzuiQQHfeFrLShKkOFVTU0wCpraGskgyC\nNl4dZPF1IDO2VjzhqqYIL2jZ8+anXsG5JshboXaNkcBal5bVwAEmcBb9FbuHmOWY\nlX5+Tb311dxw2xtH2+9FTWLo82pD3nr9G2p7CDqjAT5uRpw=\n-----END CERTIFICATE-----\n'
get_domains_from_certificate(data)
"""